*> Profile Creation Module
IDENTIFICATION DIVISION.
PROGRAM-ID. PROFILE-CREATION.

DATA DIVISION.
WORKING-STORAGE SECTION.
COPY "AccountRecord.cpy".

01  PROFILE-STATUS        PIC X VALUE "N".
01  PROFILE-RESPONSE      PIC X(100).

LINKAGE SECTION.
01  L-USERNAME            PIC X(50).
01  L-PROFILE-STATUS      PIC X.
01  L-PROFILE-RESPONSE    PIC X(100).

PROCEDURE DIVISION USING L-USERNAME L-PROFILE-STATUS L-PROFILE-RESPONSE.
    MOVE "N" TO PROFILE-STATUS
    MOVE SPACES TO PROFILE-RESPONSE

    *> Initialize profile fields in AccountRecord structure
    MOVE SPACES TO AR-FIRST-NAME
    MOVE SPACES TO AR-LAST-NAME
    MOVE SPACES TO AR-UNIVERSITY
    MOVE SPACES TO AR-MAJOR
    MOVE 0 TO AR-GRADUATION-YEAR
    MOVE SPACES TO AR-ABOUT-ME

    *> Use the new profile input handler for validation and storage
    CALL 'PROFILE-INPUT-HANDLER' USING L-USERNAME AR-FIRST-NAME AR-LAST-NAME
                                      AR-UNIVERSITY AR-MAJOR AR-GRADUATION-YEAR
                                      AR-ABOUT-ME PROFILE-STATUS PROFILE-RESPONSE

    MOVE PROFILE-STATUS TO L-PROFILE-STATUS
    MOVE PROFILE-RESPONSE TO L-PROFILE-RESPONSE

    GOBACK.

